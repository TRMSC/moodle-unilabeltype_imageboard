define("unilabeltype_imageboard/imageboardrenderer",["exports"],(function(_exports){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0;_exports.init=cmid=>{docReady(createimageboard(cmid))};const docReady=callback=>{"complete"===document.readyState||"interactive"===document.readyState?setTimeout(callback,1):document.addEventListener("DOMContentLoaded",callback)},createimageboard=cmid=>{!function(cmid){const myContext=document.getElementById("unilabeltype-imageboard-canvas-"+cmid).getContext("2d"),canvaswidth=document.querySelector(".imageboard-"+cmid).getAttribute("data-canvaswidth"),canvasheight=document.querySelector(".imageboard-"+cmid).getAttribute("data-canvasheight");let newcanvaswidth=1,widthfactor=1,newcanvasheight=1;canvaswidth>getWidth()?(newcanvaswidth=.9*getWidth(),widthfactor=newcanvaswidth/canvaswidth,newcanvasheight=canvasheight*widthfactor,myContext.canvas.width=newcanvaswidth,myContext.canvas.height=newcanvasheight):(myContext.canvas.width=canvaswidth,myContext.canvas.height=canvasheight);window.addEventListener("resize",(function(){canvaswidth>getWidth()&&(newcanvaswidth=.9*getWidth(),widthfactor=newcanvaswidth/canvaswidth,newcanvasheight=canvasheight*widthfactor,myContext.canvas.width=newcanvaswidth,myContext.canvas.height=newcanvasheight)}),!1)}(cmid),function(cmid){const backgroundimageurl=document.querySelector(".imageboard-"+cmid).getAttribute("data-backgroundimage");var backgroundImage=new Image;backgroundImage.src=backgroundimageurl;const myContext=document.getElementById("unilabeltype-imageboard-canvas-"+cmid).getContext("2d");var canvaswidth=document.querySelector(".imageboard-"+cmid).getAttribute("data-canvaswidth"),canvasheight=document.querySelector(".imageboard-"+cmid).getAttribute("data-canvasheight");canvaswidth=400,canvasheight=300,alert("backgroundimageurl="+backgroundimageurl),myContext.drawImage(backgroundImage,0,0,canvaswidth,canvasheight)}(cmid),function(cmid){const canvaswidth=document.querySelector(".imageboard-"+cmid).getAttribute("data-canvaswidth"),showborders=(document.querySelector(".imageboard-"+cmid).getAttribute("data-canvasheight"),document.querySelector(".imageboard-"+cmid).getAttribute("data-showborders")),bordercolor=document.querySelector(".imageboard-"+cmid).getAttribute("data-bordercolor");document.querySelectorAll(".imageboardimage-"+cmid).forEach((image=>{!function(cmid,canvaswidth,canvasheight,showborders,bordercolor,image){let title=image.title,url=image.url,imageurl=image.imageurl,targetwidth=image.targetwidth,targetheight=image.targetheight,xposition=image.xposition,yposition=image.yposition;const myCanvas=document.getElementById("unilabeltype-imageboard-canvas-"+cmid),myContext=myCanvas.getContext("2d"),img=new Image;let font="20px Arial";const fillstylebackground="#f50";img.src=imageurl;let widthfactor=1,titleheight=0;alert("todo: Add timeout so that images "),canvaswidth>getWidth()&&(widthfactor=.9*getWidth()/canvaswidth);if(0!=targetwidth&&0!=targetheight);else if(0==targetheight)if(0==targetwidth)targetwidth=img.width,targetheight=img.height;else{let faktor=targetwidth/img.width;targetheight=img.height*faktor}else if(0==targetheight)targetwidth=img.width,targetheight=img.height;else{let faktor=targetheight/img.height;targetwidth=img.width*faktor}if(myContext.drawImage(img,xposition*widthfactor,yposition*widthfactor,targetwidth*widthfactor,targetheight*widthfactor),showborders){drawBorder(myContext,xposition*widthfactor,yposition*widthfactor,targetwidth*widthfactor,targetheight*widthfactor,!1,bordercolor,1)}""!=title&&(titleheight=30,myContext.fillStyle=fillstylebackground,myContext.fillRect(xposition*widthfactor-1,yposition*widthfactor-(titleheight+1),targetwidth*widthfactor+1,titleheight),myContext.fillStyle="#fff",myContext.font=font,myContext.fillText(title,xposition*widthfactor,yposition*widthfactor-10));myCanvas.addEventListener("click",(function(event){const rect=myCanvas.getBoundingClientRect(),x=event.clientX-rect.left,y=event.clientY-rect.top;if(x>xposition*widthfactor&&x<xposition*widthfactor+targetwidth*widthfactor&&y>yposition*widthfactor-titleheight&&y<yposition*widthfactor+targetheight*widthfactor)url&&(window.location=url);else{"1"==document.querySelector(".imageboard-"+cmid).getAttribute("data-capababilityforgrid")&&function(cmid){const ctx=document.getElementById("unilabeltype-imageboard-canvas-"+cmid).getContext("2d");let strokeStyle="#841ba1",strokeWidth=1;const canvaswidth=document.querySelector(".imageboard-"+cmid).getAttribute("data-canvaswidth");let widthfactor=ctx.canvas.width/canvaswidth;ctx.beginPath();let x=1,y=1;for(let a=1;a<15;a++){for(let i=1;i<23;i++)ctx.rect(x,y,50*widthfactor,50*widthfactor),x+=50*widthfactor;x=1,y+=50*widthfactor}strokeStyle&&(ctx.lineWidth=strokeWidth,ctx.strokeStyle=strokeStyle,ctx.stroke())}(cmid)}}),!1),window.addEventListener("resize",(function(){if(canvaswidth>getWidth()){if(widthfactor=.9*getWidth()/canvaswidth,myContext.drawImage(img,xposition*widthfactor,yposition*widthfactor,targetwidth*widthfactor,targetheight*widthfactor),showborders)drawBorder(myContext,xposition*widthfactor,yposition*widthfactor,targetwidth*widthfactor,targetheight*widthfactor,!1,bordercolor,1);""!=title&&(myContext.fillStyle=fillstylebackground,myContext.fillRect(xposition*widthfactor-1,yposition*widthfactor-(titleheight+1),targetwidth*widthfactor+1,titleheight),myContext.fillStyle="#fff",myContext.font=font,myContext.fillText(title,xposition*widthfactor,yposition*widthfactor-10))}}),!1)}(cmid,canvaswidth,0,showborders,bordercolor,image.dataset)}))}(cmid)};function getWidth(){return self.innerWidth?self.innerWidth:document.documentElement&&document.documentElement.clientWidth?document.documentElement.clientWidth:document.body?document.body.clientWidth:void 0}function drawBorder(ctx,x,y,width,height,fill,strokeStyle,strokeWidth){ctx.beginPath(),ctx.rect(x,y,width,height),ctx.shadowColor="#f00",ctx.shadowBlur=0,ctx.shadowOffsetX=0,ctx.shadowOffsetY=0,fill&&(ctx.fillStyle=fill,ctx.fill()),strokeStyle&&(ctx.lineWidth=strokeWidth,ctx.strokeStyle=strokeStyle,ctx.stroke())}}));

//# sourceMappingURL=imageboardrenderer.min.js.map