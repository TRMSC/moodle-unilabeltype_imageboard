{{!
    This file is part of Moodle - http://moodle.org/

    Moodle is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    Moodle is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with Moodle.  If not, see <http://www.gnu.org/licenses/>.
}}
{{!
    @template unilabeltype_imageboard/imageboard
    Template to show a bootstrap modal dialog.

    Example context (json):
    {
      "showintro": false,
      "intro": "",
      "images": [
        {
          "id": "9",
          "imageboardid": "1",
          "title": "",
          "url": "http:\/\/localhost:8000\/mod\/forum\/view.php?id=136",
          "xposition": "150",
          "yposition": "100",
          "targetwidth": "80",
          "targetheight": "0",
          "imageurl": {},
          "nr": 0
        },
        {
          "id": "10",
          "imageboardid": "1",
          "title": "",
          "url": "",
          "xposition": "400",
          "yposition": "200",
          "targetwidth": "0",
          "targetheight": "0",
          "imageurl": {http:\/\/localhost:8000\/mod\/forum\/view.php?id=137},
          "nr": 1
        }
      ],
      "hasimages": true,
      "cmid": "140",
      "canvaswidth": "500",
      "autocanvaswidth": false,
      "canvasheight": "600",
      "autocanvasheight": false,
      "backgroundimage": {},
      "capababilityforgrid": true,
      "showborders": true,
      "bordercolor": "#2D57FA",
      "gridcolor": "#B7009E"
    }
}}

{{#showintro}}
    {{{intro}}}
{{/showintro}}


{{#capababilityforgrid}}
    <button id="unilabeltype-imageboard-gridtoggler-{{cmid}}">show/hide 50x50px grid</button>
{{/capababilityforgrid}}
<button id="unilabeltype-imageboard-resizer-{{cmid}}">Fit to screenwidth</button>

<div id="unilabeltype-imageboard-{{cmid}}"
     style="position: relative;
             background: url('{{backgroundimage}}');
             width: {{canvaswidth}}px;
             height: {{canvasheight}}px;
             background-size: cover;">
    {{#images}}
        {{#url}}
            <a href="{{url}}">
        {{/url}}
            <div style="position: absolute;
                    z-index: 5;
                    left: {{xposition}}px;
                    top: calc({{yposition}}px - 36px);
                    color: #fff; background-color: #3399ff;
                    font-size: 24px;">
                {{title}}
            </div>

            {{#imageurl}}
                <div style="position: absolute;
                        z-index: 5;
                        left: {{xposition}}px;
                        top:{{yposition}}px;
                    {{#hastargetwidth}}width: {{targetwidth}}px; {{/hastargetwidth}}
                    {{#hastargetheight}}height: {{targetheight}}px; {{/hastargetheight}}">

                    <img src="{{imageurl}}" style="object-fit: contain;
                            width: 100%;
                            height: 100%;
                            {{#showborders}} {{#border}}border: solid {{border}}px {{bordercolor}};{{/border}} {{/showborders}};">
                </div>
            {{/imageurl}}
        {{#url}}
            </a>
        {{/url}}
    {{/images}}

    {{#capababilityforgrid}}
        {{#helpergrids}}
            <div class="unilabeltype-imageboard-helpergrid-{{cmid}}" style="position: absolute;
                    left: {{x}}px;
                    top: {{y}}px;
                    width: 50px;
                    height: 50px;
                    border-right: solid 1px {{gridcolor}};
                    border-bottom: solid 1px {{gridcolor}};
                    z-index: 1;">
            </div>
        {{/helpergrids}}
    {{/capababilityforgrid}}
</div>


<div class="unilabel-imageboard-list">
    <p class="unilabel-imageboard-list-button">
        <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapseExample{{cmid}}"
                aria-expanded="false" aria-controls="collapseExample">
            Bilderliste und deren Links falls vorhanden:
        </button>
    </p>
    <div class="collapse" id="collapseExample{{cmid}}">
        <div class="card card-body">
            {{#images}}
                {{#url}}
                    {{#imageurl}}
                        <a href="{{{url}}}">
                            <div class="row" style="margin-left:20px; max-width: 500px;">
                                <div class="unilabel-imageboard-list-nr">
                                    {{nr}}
                                </div>
                                <div>
                                    <img src="{{{imageurl}}}" width="40px" style="margin-right: 5px;"
                                         alt="{{{title}}}"></img>
                                    {{{title}}}
                                </div>
                            </div>
                        </a>
                    {{/imageurl}}
                    {{^imageurl}}
                        <a href="{{{url}}}">
                            <div class="row" style="margin-left:20px; max-width: 500px;">
                                <div class="unilabel-imageboard-list-nr">
                                    {{nr}}
                                </div>
                                <div class="border" style="width: 40px; height: 40px; margin-right: 5px;">
                                </div>
                                <div class="unilabel-imageboard-list-title">
                                    {{{title}}}
                                </div>
                            </div>
                        </a>
                    {{/imageurl}}
                {{/url}}
                {{^url}}
                    <div class="row" style="margin-left:20px; max-width: 500px;">
                        <div class="unilabel-imageboard-list-nr">
                            {{nr}}
                        </div>
                        <div>
                            <img src="{{{imageurl}}}" width="40px;" style="margin-right: 5px;" alt="{{{title}}}"></img>
                            {{{title}}}
                        </div>
                    </div>
                {{/url}}
            {{/images}}
        </div>
    </div>
</div>

{{#js}}
    require(['unilabeltype_imageboard/imageboardrenderer'],
    function(imageboardrenderer) {
    imageboardrenderer.init({{cmid}}, {{canvaswidth}}, {{canvasheight}});
    }
    );
{{/js}}
